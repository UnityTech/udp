<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/udp/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/udp/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/udp/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/udp/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/udp/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/udp/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/udp/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="This session provides the detailed description of integrating your game with UDP.  Client-Side Integration#The client-side integration consists of the following steps:  Initialize the UDP SDK Check wh">
<meta property="og:type" content="website">
<meta property="og:title" content="Technical Integration (without Unity IAP)">
<meta property="og:url" content="https://unitytech.github.io/udp/technical-integration/index.html">
<meta property="og:site_name" content="Unity Distribution Platform">
<meta property="og:description" content="This session provides the detailed description of integrating your game with UDP.  Client-Side Integration#The client-side integration consists of the following steps:  Initialize the UDP SDK Check wh">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-06-19T12:37:29.579Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Technical Integration (without Unity IAP)">
<meta name="twitter:description" content="This session provides the detailed description of integrating your game with UDP.  Client-Side Integration#The client-side integration consists of the following steps:  Initialize the UDP SDK Check wh">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/udp/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://unitytech.github.io/udp/technical-integration/"/>





  <title>Technical Integration (without Unity IAP) | Unity Distribution Platform</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/udp/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Unity Distribution Platform</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/udp/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/udp/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-quick-guide">
          <a href="/udp/Quick-Guide/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            Quick Guide
          </a>
        </li>
      
        
        <li class="menu-item menu-item-document">
          <a href="/udp/UDP-Guide/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            Document
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline">Technical Integration (without Unity IAP)</h1>



</header>

      
      
      
      <div class="post-body">
        
        
          <p><br><br>This session provides the detailed description of integrating your game with UDP. </p>
<h2><span id="client-side-integration">Client-Side Integration</span><a href="#client-side-integration" class="header-anchor">#</a></h2><p>The client-side integration consists of the following steps:</p>
<ul>
<li>Initialize the UDP SDK</li>
<li>Check whether there are products that are purchased but not consumed</li>
<li>Implement listeners for events that are related to the purchase service, including purchasing, consumption, and querying inventory</li>
<li>Purchase a product</li>
<li>Consume a purchase</li>
</ul>
<h3><span id="initializing-the-udp-sdk">Initializing the UDP SDK</span><a href="#initializing-the-udp-sdk" class="header-anchor">#</a></h3><p>To initialize the UDP SDK, call the <code>Initialize</code> method with <code>AppInfo</code> and <code>IInitCallback</code>.<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StoreService.Initialize(AppInfo, IInitCallback)</span><br></pre></td></tr></table></figure></p>
<p>If you create the client using the <code>Game Settings.asset</code> file, your game can retrieve <code>AppInfo</code> by reading the file. Here is an example:<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AppStoreSettings appStoreSettings = Resources.Load&lt;AppStoreSettings&gt;(<span class="string">"GameSettings"</span>);</span><br><span class="line">AppInfo appInfo = <span class="keyword">new</span> AppInfo();</span><br><span class="line">appInfo.appName = appStoreSettings.AppSlug;</span><br><span class="line">appInfo.clientId = appStoreSettings.UnityClientID;</span><br><span class="line">appInfo.clientKey = appStoreSettings.UnityClientKey;</span><br><span class="line">appInfo.RSAPublicKey = appStoreSettings.UnityClientRSAPublicKey;</span><br></pre></td></tr></table></figure></p>
<p>Otherwise, you must fill in <code>AppInfo</code> manually.</p>
<p>Then <code>InitListener</code> will notify your game whether the initialization succeeds.<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">InitCallback</span> : <span class="title">IInitListener</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnInitialized</span>(<span class="params">UserInfo userInfo</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Debug.Log(<span class="string">"Initialization succeeded"</span>);</span><br><span class="line">        <span class="comment">// Developers can call queryInventory here</span></span><br><span class="line">        <span class="comment">// to see if there are purchases needed to be consumed        </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnInitializeFailed</span>(<span class="params"><span class="keyword">string</span> message</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Debug.Log(<span class="string">"Initialization failed: "</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3><span id="querying-for-specified-items-or-all-unconsumed-items">Querying for specified items or all unconsumed items</span><a href="#querying-for-specified-items-or-all-unconsumed-items" class="header-anchor">#</a></h3><p>In you game, you can query the item details with <code>QueryInventort</code>. If you specify <code>productIds</code>, you can get the information of your specified items. If you don’t specify <code>productIdS</code>, you can get the information of all items that are purchased but not consumed. Here is an example: </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PurchaseService.QueryInventory(productIds, callback);</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">PurchaseService.QueryInventory(callback);</span><br><span class="line"><span class="comment">// or</span></span><br></pre></td></tr></table></figure>
<div> Note: Call this method after a successful initialization. This step can prevent the situation where an item is purchased but not delivered to the player for some reason, such as an application crash.</div>

<h3><span id="implementing-listeners-for-events-that-are-related-to-the-purchase-service">Implementing listeners for events that are related to the purchase service</span><a href="#implementing-listeners-for-events-that-are-related-to-the-purchase-service" class="header-anchor">#</a></h3><p><code>IPurchaseListener</code> provides the following listeners that tell you the result of all purchase-related events:</p>
<ul>
<li><code>OnPurchase</code> tells you that the purchase succeeded. </li>
<li><code>OnPurchaseFailed</code> tells you that the purchase failed. </li>
<li><code>OnPurchaseRepeated</code> is used when a player buys a non-consumable product several times. You can implement this listener when the partner store doesn’t support <code>QueryInventory</code>. </li>
<li><code>OnPurchaseConsume</code> tells you that the consumption succeeded.</li>
<li><code>OnPurchaseConsumeFailed</code> tells you that the consumption failed. </li>
<li><code>OnQueryInventory</code> tells you that the querying succeeded. </li>
<li><code>OnQueryInventoryFailed</code> tell you that the query failed. </li>
</ul>
<p>Here is an example:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PurchaseCallback</span> : <span class="title">IPurchaseListener</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPurchase</span>(<span class="params">PurchaseInfo purchaseInfo</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// The purchase has succeeded.</span></span><br><span class="line">        <span class="comment">// If the purchased item is consumable, you should consume it here.</span></span><br><span class="line">        <span class="comment">// Otherwise, deliver the product.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPurchaseFailed</span>(<span class="params"><span class="keyword">string</span> message, PurchaseInfo purchaseInfo</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Debug.Log(<span class="string">"Purchase Failed: "</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPurchaseRepeated</span>(<span class="params"><span class="keyword">string</span> productCode</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Some stores don't support queryInventory,</span></span><br><span class="line">        <span class="comment">// when buying non-consumable products repeatedly,</span></span><br><span class="line">        <span class="comment">// This listener will be triggered.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPurchaseConsume</span>(<span class="params">PurchaseInfo purchaseInfo</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// The consumption succeeded.</span></span><br><span class="line">        <span class="comment">// You should deliver the product here.        </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPurchaseConsumeFailed</span>(<span class="params"><span class="keyword">string</span> message, PurchaseInfo purchaseInfo</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// The consumption failed.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnQueryInventory</span>(<span class="params">Inventory inventory</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Querying inventory succeeded.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnQueryInventoryFailed</span>(<span class="params"><span class="keyword">string</span> message</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Querying inventory failed.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="purchasing-an-item">Purchasing an item</span><a href="#purchasing-an-item" class="header-anchor">#</a></h3><p>To start a purchase request from your game, call the <code>Purchase</code> method and provide <code>productId</code>, <code>cpOrderId</code>, and <code>developerPayload</code>.<br><code>productId</code> is the product that the player wants to buy. <code>cpOrderId</code> is a unique order ID defined by yourself. If you provide a null for this argument, the SDK for UDP will generate a UUID automatically.  <code>developerPayload</code> is whatever information you want to send to the SDK for UDP. The information will be returned after the purchase is completed.</p>
<p>Here is an example:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PurchaseService.Purchase(<span class="string">"productId"</span>, <span class="string">"cpOrderId"</span>, <span class="string">"developerPayload"</span>, PurchaseCallback);</span><br></pre></td></tr></table></figure>
<h3><span id="consuming-a-purchase">Consuming a purchase</span><a href="#consuming-a-purchase" class="header-anchor">#</a></h3><p>If an item is purchased, it can’t be purchased until it has been consumed. So the consumption is used to make sure the purchased item is successfully delivered. Here is an example:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PurchaseService.ConsumePurchase(PurchaseInfo, IPurchaseListener);</span><br></pre></td></tr></table></figure>
<p><code>PurchaseInfo</code> is returned by <code>OnPurchase</code>.</p>
<h3><span id="client-side-validation">Client-Side Validation</span><a href="#client-side-validation" class="header-anchor">#</a></h3><p>UDP performs client-side validations automatically. When partner stores return the payload and signature after a successful purchase, UDP SDK validates the signature. If the validation fails, the purchase fails accordingly.</p>
<h2><span id="server-side-integration">Server-Side Integration</span><a href="#server-side-integration" class="header-anchor">#</a></h2><h3><span id="implementing-callback-notification">Implementing Callback Notification</span><a href="#implementing-callback-notification" class="header-anchor">#</a></h3><p>After a purchase succeeds, the Unity Channel server notifies the game server with the payment result. Implement an HTTP request GET and accept the following query parameters.</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Required</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr>
<td>payload</td>
<td>Yes</td>
<td>the order content which is in Json String format (details can be seen in the table below)</td>
<td>Json String</td>
</tr>
<tr>
<td>signature</td>
<td>Yes</td>
<td>RSA signature with the payload</td>
<td>String</td>
</tr>
<tr>
<td>certificate</td>
<td>Yes</td>
<td>X.509 certificate that contains the RSA public key for the signature</td>
<td>Base64 encoded String</td>
</tr>
</tbody>
</table>
<h4><span id="using-the-certificate">Using the certificate</span><a href="#using-the-certificate" class="header-anchor">#</a></h4><p>You can verify the certificate using the Unity Client RSA Public Key. If the certificate pass the verification, extract the RSA public key from the certificate and use this key to verify the payload with the signature by SHA1 algorithm.</p>
<p>Here is the code sample in Java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.X509Certificate;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.Signature;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">verify</span> <span class="params">(String publicKey, String certificate, String payload, String signature)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// verify certificate</span></span><br><span class="line">	Base64.Decoder decoder = Base64.getDecoder();</span><br><span class="line">	<span class="keyword">byte</span>[] certBytes = decoder.decode(certificate.getBytes(<span class="string">"UTF-8"</span>));</span><br><span class="line">	CertificateFactory certFactory = CertificateFactory.getInstance(<span class="string">"X.509"</span>);</span><br><span class="line">	X509Certificate cert = (X509Certificate)certFactory.generateCertificate(<span class="keyword">new</span> ByteArrayInputStream(certBytes));</span><br><span class="line">	<span class="keyword">byte</span>[] keyBytes = decoder.decode(publicKey.getBytes(<span class="string">"UTF-8"</span>));</span><br><span class="line">	X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(keyBytes);</span><br><span class="line">	KeyFactory fact = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">	PublicKey pubKey = fact.generatePublic(keySpec);</span><br><span class="line">	<span class="keyword">if</span> (cert.notAfter.before(<span class="keyword">new</span> Date())) &#123;</span><br><span class="line">		<span class="comment">// expired certificate, verification failed</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		cert.verify(pubKey);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		<span class="comment">// verification failed</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// verify signature</span></span><br><span class="line">	Signature signature = Signature.getInstance(<span class="string">"SHA1WithRSA"</span>);</span><br><span class="line">	signature.initVerify(cert.getPublicKey());</span><br><span class="line">	signature.update(payload.getBytes(<span class="string">"UTF-8"</span>));</span><br><span class="line">	<span class="keyword">boolean</span> verified = signature.verify(decoder.decode(signature.getBytes(<span class="string">"UTF-8"</span>)));</span><br><span class="line">	<span class="keyword">if</span> (!verified) &#123;</span><br><span class="line">		<span class="comment">// verification failed</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here is the content of JSON payload:</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Required?</th>
<th>Description</th>
<th>Format</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr>
<td>cpOrderId</td>
<td>Yes</td>
<td>order id assigned by Game</td>
<td>String</td>
<td>66mea52wne</td>
</tr>
<tr>
<td>status</td>
<td>Yes</td>
<td>status of the orderAttempt</td>
<td>String</td>
<td>SUCCESS</td>
</tr>
<tr>
<td>amount</td>
<td>Yes</td>
<td>pay fee of this order</td>
<td>String</td>
<td>1</td>
</tr>
<tr>
<td>productId</td>
<td>Yes</td>
<td>product id of the product associated with the order</td>
<td>String</td>
<td>Product_1</td>
</tr>
<tr>
<td>payTime</td>
<td>Yes</td>
<td>order paid time</td>
<td>ISO8601 yyyy-MM-ddThh:mm:ssZ, UTC timezone</td>
<td>2017-03-08T06:43:20Z</td>
</tr>
<tr>
<td>country</td>
<td>Yes</td>
<td>country</td>
<td>ISO 3166-2</td>
<td>US</td>
</tr>
<tr>
<td>currency</td>
<td>Yes</td>
<td>currency</td>
<td>ISO 4217 or cryptocurrency type</td>
<td>USD</td>
</tr>
<tr>
<td>cryptocurrency</td>
<td>Yes</td>
<td>if the currency is cryptocurrency</td>
<td>Boolean</td>
<td>False</td>
</tr>
<tr>
<td>quantity</td>
<td>Yes</td>
<td>quantity of the product</td>
<td>Integer</td>
<td>1</td>
</tr>
<tr>
<td>clientId</td>
<td>Yes</td>
<td>client id returned after Game onboarding to Unity IAP</td>
<td>String</td>
<td>P-wU0n9pbyQ1ulks4kHX_Q</td>
</tr>
<tr>
<td>extension</td>
<td>No</td>
<td>extension</td>
<td>String</td>
<td>“{\”abc\” : \”123\”}”</td>
</tr>
</tbody>
</table>
<h3><span id="implementing-an-acknowledgement-listener">Implementing an acknowledgement listener</span><a href="#implementing-an-acknowledgement-listener" class="header-anchor">#</a></h3><p>After your game server receives a callback notification, your game server can send an acknowledgement to the Unity Channel server. Implement an HTTP request GET and accept query parameters in the following table.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET</span><br><span class="line">/v1/order-attempts/callback/ack?cpOrderId=&lt;cpOrderId&gt;&amp;clientId=&lt;clientId&gt;&amp;orderQueryToken=&lt;orderQueryToken&gt;&amp;sign=&lt;sign&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Required?</th>
<th>Description</th>
<th>Format</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr>
<td>cpOrderId</td>
<td>Yes</td>
<td>order id assigned by game , or Unity generated id if game will not generate it</td>
<td>String</td>
<td>66mea52wne</td>
</tr>
<tr>
<td>clientId</td>
<td>Yes</td>
<td>client id assigned by Unity after onboarding</td>
<td>String</td>
<td>Q4AnJDW2-rxLAPujqrk1zQ</td>
</tr>
<tr>
<td>orderQueryToken</td>
<td>Yes</td>
<td>order query token returned by client SDK when finishing purchase</td>
<td>String</td>
<td>ebaseakc=</td>
</tr>
<tr>
<td>sign</td>
<td>Yes</td>
<td>md5 with cpOrderId, clientId, orderQueryToken and Unity Client Secret. Check the algorithm in the end of the doc</td>
<td>String</td>
<td>7277da780d1102864ee5818c2730c74e</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Response: Status 200</span><br></pre></td></tr></table></figure>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Unity Technology</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/udp/archives/">
              
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Unity Technology</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/udp/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/udp/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/udp/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/udp/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/udp/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/udp/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/udp/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/udp/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/udp/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/udp/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/udp/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
